<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Cluster configuration · LogDevice</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;The main config file passed to LogDevice server through the &lt;code&gt;--config-path&lt;/code&gt; command line argument.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Cluster configuration · LogDevice"/><meta property="og:type" content="website"/><meta property="og:url" content="https://logdevice.io/index.html"/><meta property="og:description" content="&lt;p&gt;The main config file passed to LogDevice server through the &lt;code&gt;--config-path&lt;/code&gt; command line argument.&lt;/p&gt;
"/><meta property="og:image" content="https://logdevice.io/img/logdevice_og.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://logdevice.io/img/logdevice.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://logdevice.io/blog/atom.xml" title="LogDevice Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://logdevice.io/blog/feed.xml" title="LogDevice Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/facebook_logdevice_whitewordmark.png" alt="LogDevice"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/Overview.html" target="_self">Docs</a></li><li class=""><a href="/api/annotated.html" target="_self">API</a></li><li class=""><a href="/help.html" target="_self">Support</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Configuration</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting started</h3><ul><li class="navListItem"><a class="navItem" href="/docs/Overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/Concepts.html">Concepts and architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/Terminology.html">Terminology</a></li><li class="navListItem"><a class="navItem" href="/docs/Installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/LocalCluster.html">Running a local cluster</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Configuration</h3><ul><li class="navListItem"><a class="navItem" href="/docs/FirstCluster.html">Creating your first cluster</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Config.html">Cluster configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/Settings.html">Settings</a></li><li class="navListItem"><a class="navItem" href="/docs/Logs.html">Log configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Administration</h3><ul><li class="navListItem"><a class="navItem" href="/docs/LDShell.html">LogDevice Shell</a></li><li class="navListItem"><a class="navItem" href="/docs/LDQuery.html">LDQuery</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API</h3><ul><li class="navListItem"><a class="navItem" href="/docs/API_Intro.html">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/API_Doxygen.html">Reference</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Extending LogDevice</h3><ul><li class="navListItem"><a class="navItem" href="/docs/WritingPlugins.html">Writing plugins</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Cluster configuration</h1></header><article><div><span><p>The main config file passed to LogDevice server through the <code>--config-path</code> command line argument.
The same file can be used to create a client, for which it is passed in the constructor.</p>
<p>A simple config file structure looks as follows:</p>
<pre><code class="hljs">{
  <span class="hljs-attr">"client_settings"</span>: {},
  <span class="hljs-attr">"server_settings"</span>: {},
  <span class="hljs-attr">"cluster"</span>: <span class="hljs-string">"your_cluster_name"</span>,
  <span class="hljs-attr">"internal_logs"</span>: {},
  <span class="hljs-attr">"metadata_logs"</span>: {},
  <span class="hljs-attr">"nodes"</span>: [],
  <span class="hljs-attr">"traffic_shaping"</span>: {},
  <span class="hljs-attr">"version"</span>: <span class="hljs-number">123</span>,
  <span class="hljs-attr">"zookeeper"</span>: {}
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="cluster-cluster"></a><a href="#cluster-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cluster (<code>cluster</code>)</h2>
<p>The cluster name is used for handshaking between clients and servers. This will enforce that clients and servers use a config file with the same cluster identifier. It is also used as part of the path of znodes in ZooKeeper, so make sure this is different for every tier.</p>
<h2><a class="anchor" aria-hidden="true" id="internal-logs-internal-logs"></a><a href="#internal-logs-internal-logs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Internal logs (<code>internal_logs</code>)</h2>
<p>Internal logs are used for:</p>
<ul>
<li>Logs configuration</li>
<li>Event log</li>
</ul>
<p>Both of these have a delta and and snapshot log. Their log ranges are hard-coded, but their replication can be <a href="/docs/Logs.html">configured dynamically</a>.
Since a lot of LogDevice internals depend on these logs, you want higher fault-tolerance than normal data logs.</p>
<pre><code class="hljs"><span class="hljs-string">"internal_logs"</span>: {
    <span class="hljs-string">"config_log_deltas"</span>: {
        <span class="hljs-string">"extra_copies"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">"max_writes_in_flight"</span>: <span class="hljs-number">2000</span>,
        <span class="hljs-string">"nodeset_size"</span>: <span class="hljs-number">20</span>,
        <span class="hljs-string">"replicate_across"</span>: {
            <span class="hljs-string">"node"</span>: <span class="hljs-number">6</span>,
            <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
        },
        <span class="hljs-string">"scd_enabled"</span>: false,
        <span class="hljs-string">"synced_copies"</span>: <span class="hljs-number">0</span>
    },
    <span class="hljs-string">"config_log_snapshots"</span>: {
        <span class="hljs-string">"extra_copies"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">"max_writes_in_flight"</span>: <span class="hljs-number">2000</span>,
        <span class="hljs-string">"nodeset_size"</span>: <span class="hljs-number">20</span>,
        <span class="hljs-string">"replicate_across"</span>: {
            <span class="hljs-string">"node"</span>: <span class="hljs-number">6</span>,
            <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
        },
        <span class="hljs-string">"scd_enabled"</span>: false,
        <span class="hljs-string">"synced_copies"</span>: <span class="hljs-number">0</span>
    },
    <span class="hljs-string">"event_log_deltas"</span>: {
        <span class="hljs-string">"extra_copies"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">"max_writes_in_flight"</span>: <span class="hljs-number">2000</span>,
        <span class="hljs-string">"nodeset_size"</span>: <span class="hljs-number">20</span>,
        <span class="hljs-string">"replicate_across"</span>: {
            <span class="hljs-string">"node"</span>: <span class="hljs-number">6</span>,
            <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
        },
        <span class="hljs-string">"scd_enabled"</span>: false,
        <span class="hljs-string">"synced_copies"</span>: <span class="hljs-number">0</span>
    },
    <span class="hljs-string">"event_log_snapshots"</span>: {
        <span class="hljs-string">"extra_copies"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-string">"max_writes_in_flight"</span>: <span class="hljs-number">2000</span>,
        <span class="hljs-string">"nodeset_size"</span>: <span class="hljs-number">20</span>,
        <span class="hljs-string">"replicate_across"</span>: {
        <span class="hljs-string">"replicate_across"</span>: {
            <span class="hljs-string">"node"</span>: <span class="hljs-number">6</span>,
            <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
        },
        <span class="hljs-string">"scd_enabled"</span>: false,
        <span class="hljs-string">"synced_copies"</span>: <span class="hljs-number">0</span>
    }
},
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="metadata-logs-metadata-logs"></a><a href="#metadata-logs-metadata-logs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Metadata logs (<code>metadata logs</code>)</h2>
<p>Metadata log configuration requires an explicit nodeset. This nodeset is crucial to the system and should always be read and write available. Metadata nodeset can be changed as long as a subset of the nodes is still maintained and data is overreplicated manually, but this is generally a dangerous operation.</p>
<p>Replication constraints should <strong>not</strong> be changed without proper caution once the cluster is up and running.</p>
<p>The metadata nodeset should contain as many failure domains as possible to ensure availability.</p>
<pre><code class="hljs"><span class="hljs-string">"metadata_logs"</span>: {
    <span class="hljs-string">"nodeset"</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">25</span>, <span class="hljs-number">30</span>, <span class="hljs-number">35</span>, <span class="hljs-number">40</span>],
    <span class="hljs-string">"replicate_across"</span>: {
      <span class="hljs-string">"node"</span>: <span class="hljs-number">6</span>,
      <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
    }
  },
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="nodes-nodes"></a><a href="#nodes-nodes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nodes (<code>nodes</code>)</h2>
<p>Nodes is an array of node objects. An example node object would be:</p>
<pre><code class="hljs">{
    <span class="hljs-string">"generation"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"gossip_port"</span>: <span class="hljs-number">4441</span>,
    <span class="hljs-string">"host"</span>: <span class="hljs-string">"127.0.0.1:4440"</span>,
    <span class="hljs-string">"roles"</span>: [
        <span class="hljs-string">"sequencer"</span>,
        <span class="hljs-string">"storage"</span>
    ],
    <span class="hljs-string">"sequencer"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"storage"</span>: <span class="hljs-string">"read-write"</span>,
    <span class="hljs-string">"storage_weight"</span>: <span class="hljs-number">2</span>,
    <span class="hljs-string">"location"</span>: <span class="hljs-string">"abc.def.gh.ij.kl"</span>,
    <span class="hljs-string">"node_id"</span>: <span class="hljs-number">0</span>,
    <span class="hljs-string">"num_shards"</span>: <span class="hljs-number">15</span>,
    <span class="hljs-string">"ssl_port"</span>: <span class="hljs-number">4443</span>,
},
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="node-id-node-id"></a><a href="#node-id-node-id" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Node ID (<code>node_id</code>)</h3>
<p>A unique identifier for a node. This should not be changed during the lifetime of a host.</p>
<h3><a class="anchor" aria-hidden="true" id="host-host"></a><a href="#host-host" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Host (<code>host</code>)</h3>
<p>Host is an IP:port pair. The port is the data port (non-ssl) to which both nodes and clients connect when SSL is disabled.
For IPv6, the <code>[::1]:4440</code> format can be used.</p>
<h3><a class="anchor" aria-hidden="true" id="location-location"></a><a href="#location-location" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Location (<code>location</code>)</h3>
<p>Location is used to encode the failure domain of a the host. This is used for data placement, based on the <a href="/docs/Logs.html">log configuration</a></p>
<p>The format of the string is: <code>region.datacenter.cluster.row.rack</code>.
As an example, a log configuration using:</p>
<pre><code class="hljs"><span class="hljs-string">"replicate_across"</span>: {
      <span class="hljs-string">"rack"</span>: <span class="hljs-number">3</span>
}
</code></pre>
<p>can be placed on machines with 3 different rack identifiers (but could share same <code>region.datacenter.cluster.row</code>):</p>
<ul>
<li><code>00.00.00.00.01</code></li>
<li><code>00.00.00.00.02</code></li>
<li><code>00.00.00.00.03</code></li>
</ul>
<p>Each section can be expressed as a string.</p>
<h3><a class="anchor" aria-hidden="true" id="roles-and-state-roles-sequencer-sequencer-weight-storage-and-storage-weight"></a><a href="#roles-and-state-roles-sequencer-sequencer-weight-storage-and-storage-weight" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Roles and state (<code>roles</code>, <code>sequencer</code>, <code>sequencer_weight</code>, <code>storage</code> and <code>storage_weight</code>)</h3>
<p>A distinction should be made between roles and state:</p>
<ul>
<li>Role: this remains the same during the lifetime of the node.</li>
<li>State: could change (for e.g. maintenance operations)</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="roles-permanent-properties"></a><a href="#roles-permanent-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Roles / permanent properties</h4>
<p><code>roles</code> is defined as a list, and can combine the following options:</p>
<ul>
<li><code>sequencer</code></li>
<li><code>storage</code></li>
</ul>
<p><code>storage_weight</code> defines a proportional value for the amount of data to be stored compared to other machines. When e.g. total disk size is used as weight for machines with variable disk sizes, the storage will be used proportionally.
<code>sequencer_weight</code> can similarly define a proportional value for the number of sequencers to be placed on the machine.</p>
<h4><a class="anchor" aria-hidden="true" id="state"></a><a href="#state" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>State</h4>
<p>The following variables can be used to perform maintenances / temporarily change the state of a node:</p>
<p><code>storage</code> can have the following values:</p>
<ul>
<li><code>disabled</code>: This node does not serve reads nor writes</li>
<li><code>read-only</code>: This node still serves reads, but not writes</li>
<li><code>read-write</code>: This node takes both reads and writes</li>
</ul>
<p><code>sequencer</code> is a boolean value that can be toggled to temporarily disable or enable the sequencer (if the node has the <code>sequencer</code> role).</p>
<h3><a class="anchor" aria-hidden="true" id="gossip-port-gossip-port"></a><a href="#gossip-port-gossip-port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gossip port (<code>gossip_port</code>)</h3>
<p>The (TCP) port LogDevice uses to gossip node state internally. This is required when <code>gossip-enabled</code> is <code>true</code>.
Gossip is only used between nodes and is not required to be exposed to clients.</p>
<h3><a class="anchor" aria-hidden="true" id="generation-generation"></a><a href="#generation-generation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generation (<code>generation</code>)</h3>
<p>Generation should be increased when node ids are reused, but IP addresses are changed. Generation is used by LogDevice to infer whether the host is a physically new machine and forces clients to reconnect when bumped.</p>
<h2><a class="anchor" aria-hidden="true" id="version-version"></a><a href="#version-version" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Version (<code>version</code>)</h2>
<p><code>version</code> should be bumped whenever the <code>node</code> section has been changed. This property is used to determine whether configuration needs to be synchronized to clients or not (when <code>enable-config-synchronization</code> is <code>true</code>).
Generally, using current unix epoch timestamp is an easy way to provide incremental version numbers.</p>
<h2><a class="anchor" aria-hidden="true" id="zookeeper-settings-zookeeper"></a><a href="#zookeeper-settings-zookeeper" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Zookeeper settings (<code>zookeeper</code>)</h2>
<pre><code class="hljs"><span class="hljs-string">"zookeeper"</span>: {
    <span class="hljs-string">"quorum"</span>: [
        <span class="hljs-string">"192.168.0.5:2181"</span>,
        <span class="hljs-string">"192.168.0.6:2181"</span>,
        <span class="hljs-string">"192.168.0.7:2181"</span>,
        <span class="hljs-string">"192.168.0.8:2181"</span>,
        <span class="hljs-string">"192.168.0.9:2181"</span>
    ],
    <span class="hljs-string">"timeout"</span>: <span class="hljs-string">"30s"</span>
}
</code></pre>
<ul>
<li><code>quorum</code> defines the list of IP+port pairs of all the Zookeeper nodes. For IPv6, square brackets can be used (e.g.<code>[::1]:2183</code>)</li>
<li><code>timeout</code> defines the connection timeout.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="settings-client-settings-and-server-settings"></a><a href="#settings-client-settings-and-server-settings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Settings (<code>client_settings</code> and <code>server_settings</code>)</h2>
<p>Please check the <a href="/docs/Settings.html">settings documentation</a> for a detailed explanation on all the settings.</p>
<p>Settings are expressed as key-value pairs in both <code>client_settings</code> and <code>server_settings</code>.
For boolean-like values, any of the following can be used:</p>
<ul>
<li><code>1</code>, <code>true</code>, <code>True</code></li>
<li><code>0</code>, <code>false</code>, <code>False</code></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="traffic-shaping-traffic-shaping"></a><a href="#traffic-shaping-traffic-shaping" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Traffic shaping (<code>traffic_shaping</code>)</h2>
<p>TODO</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/FirstCluster.html"><span class="arrow-prev">← </span><span>Creating your first cluster</span></a><a class="docs-next button" href="/docs/Settings.html"><span>Settings</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#cluster-cluster">Cluster (<code>cluster</code>)</a></li><li><a href="#internal-logs-internal-logs">Internal logs (<code>internal_logs</code>)</a></li><li><a href="#metadata-logs-metadata-logs">Metadata logs (<code>metadata logs</code>)</a></li><li><a href="#nodes-nodes">Nodes (<code>nodes</code>)</a><ul class="toc-headings"><li><a href="#node-id-node-id">Node ID (<code>node_id</code>)</a></li><li><a href="#host-host">Host (<code>host</code>)</a></li><li><a href="#location-location">Location (<code>location</code>)</a></li><li><a href="#roles-and-state-roles-sequencer-sequencer-weight-storage-and-storage-weight">Roles and state (<code>roles</code>, <code>sequencer</code>, <code>sequencer_weight</code>, <code>storage</code> and <code>storage_weight</code>)</a></li><li><a href="#gossip-port-gossip-port">Gossip port (<code>gossip_port</code>)</a></li><li><a href="#generation-generation">Generation (<code>generation</code>)</a></li></ul></li><li><a href="#version-version">Version (<code>version</code>)</a></li><li><a href="#zookeeper-settings-zookeeper">Zookeeper settings (<code>zookeeper</code>)</a></li><li><a href="#settings-client-settings-and-server-settings">Settings (<code>client_settings</code> and <code>server_settings</code>)</a></li><li><a href="#traffic-shaping-traffic-shaping">Traffic shaping (<code>traffic_shaping</code>)</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logdevice.svg" alt="LogDevice" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/Overview.html">Getting Started</a><a href="/docs/FirstCluster.html">Creating your first cluster</a><a href="/api/annotated.html">C++ API Reference</a></div><div><h5>Community</h5><a href="https://facebook.com/groups/logdevice.oss/">LogDevice Users Group</a><a href="http://stackoverflow.com/questions/tagged/logdevice" target="_blank" rel="noreferrer noopener">Stack Overflow</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebookincubator/LogDevice">GitHub</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Facebook</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f0ece773627cb7003a57c0edd6ec7dd8',
                indexName: 'logdevice',
                inputSelector: '#search_input_react'
              });
            </script></body></html>