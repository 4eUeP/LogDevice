<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LogDevice API: facebook::logdevice::BufferedWriteDecoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LogDevice API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacefacebook.html">facebook</a></li><li class="navelem"><b>logdevice</b></li><li class="navelem"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html">BufferedWriteDecoder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classfacebook_1_1logdevice_1_1_buffered_write_decoder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">facebook::logdevice::BufferedWriteDecoder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afe3d17b824232aa6eb7567e3670442ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#afe3d17b824232aa6eb7567e3670442ca">decode</a> (std::vector&lt; std::unique_ptr&lt; DataRecord &gt;&gt; &amp;&amp;records, std::vector&lt; Payload &gt; &amp;payloads_out)</td></tr>
<tr class="separator:afe3d17b824232aa6eb7567e3670442ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4adcb04b0e734c118be3f1e23d4f37c"><td class="memItemLeft" align="right" valign="top"><a id="af4adcb04b0e734c118be3f1e23d4f37c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>decode</b> (std::vector&lt; std::unique_ptr&lt; DataRecord &gt;&gt; &amp;&amp;records, std::vector&lt; PayloadGroup &gt; &amp;payload_groups_out)</td></tr>
<tr class="separator:af4adcb04b0e734c118be3f1e23d4f37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114b36f88e274c8f6af45195098d5903"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#a114b36f88e274c8f6af45195098d5903">decodeOne</a> (std::unique_ptr&lt; DataRecord &gt; &amp;&amp;record, std::vector&lt; Payload &gt; &amp;payloads_out)</td></tr>
<tr class="separator:a114b36f88e274c8f6af45195098d5903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab5d71f10a80f6a75092663c2c9050c"><td class="memItemLeft" align="right" valign="top"><a id="aaab5d71f10a80f6a75092663c2c9050c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>decodeOne</b> (std::unique_ptr&lt; DataRecord &gt; &amp;&amp;record, std::vector&lt; PayloadGroup &gt; &amp;payload_groups_out)</td></tr>
<tr class="separator:aaab5d71f10a80f6a75092663c2c9050c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6631604b6190a2203bf37db8b141f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#a6a6631604b6190a2203bf37db8b141f5">decodeOneCompressed</a> (std::unique_ptr&lt; DataRecord &gt; &amp;&amp;record, CompressedPayloadGroups &amp;compressed_payload_groups_out)</td></tr>
<tr class="separator:a6a6631604b6190a2203bf37db8b141f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:afe0277293f5907fdf0b728b74e691b25"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html">BufferedWriteDecoder</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#afe0277293f5907fdf0b728b74e691b25">create</a> ()</td></tr>
<tr class="separator:afe0277293f5907fdf0b728b74e691b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56317ec50f7c9deaf4a27bca50615be1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#a56317ec50f7c9deaf4a27bca50615be1">getBatchSize</a> (const DataRecord &amp;record, size_t *size_out)</td></tr>
<tr class="separator:a56317ec50f7c9deaf4a27bca50615be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a72ed57d870d6b02646ba872f9d4ef990"><td class="memItemLeft" align="right" valign="top"><a id="a72ed57d870d6b02646ba872f9d4ef990"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>BufferedWriteDecoderImpl</b></td></tr>
<tr class="separator:a72ed57d870d6b02646ba872f9d4ef990"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afe0277293f5907fdf0b728b74e691b25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0277293f5907fdf0b728b74e691b25">&#9670;&nbsp;</a></span>create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::unique_ptr&lt;<a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html">BufferedWriteDecoder</a>&gt; facebook::logdevice::BufferedWriteDecoder::create </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a <a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html">BufferedWriteDecoder</a> instance. It can be used to decode batched writes made by any <a class="el" href="classfacebook_1_1logdevice_1_1_buffered_writer.html">BufferedWriter</a>. </p>

</div>
</div>
<a id="afe3d17b824232aa6eb7567e3670442ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3d17b824232aa6eb7567e3670442ca">&#9670;&nbsp;</a></span>decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int facebook::logdevice::BufferedWriteDecoder::decode </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::unique_ptr&lt; DataRecord &gt;&gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>records</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Payload &gt; &amp;&#160;</td>
          <td class="paramname"><em>payloads_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method is meant to be used with data records returned by the <a class="el" href="classfacebook_1_1logdevice_1_1_reader.html">Reader</a> API.</p>
<p>Original payloads are appended to `payloads_out' and they point into memory owned by this decoder after the call has returned. It is only safe to use the returned Payload instances as long as this decoder still exists. (For any successfully decoded DataRecord instances, this class assumes ownership of the payloads, which is why `records' is taken by reference.)</p>
<p>If is fine to use the same decoder instance to decode multiple batches of records read from LogDevice. However, the decoder pins memory so it should typically be short-lived (its lifetime is tied to the Payload instances in payloads_out as explained above).</p>
<dl class="section return"><dt>Returns</dt><dd>On success, returns 0. If some DataRecord's failed to decode, return -1, leaving malformed records in `records'. </dd></dl>

</div>
</div>
<a id="a114b36f88e274c8f6af45195098d5903"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114b36f88e274c8f6af45195098d5903">&#9670;&nbsp;</a></span>decodeOne()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int facebook::logdevice::BufferedWriteDecoder::decodeOne </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; DataRecord &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Payload &gt; &amp;&#160;</td>
          <td class="paramname"><em>payloads_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Same as <a class="el" href="classfacebook_1_1logdevice_1_1_buffered_write_decoder.html#afe3d17b824232aa6eb7567e3670442ca">decode()</a> but for a single record only.</p>
<dl class="section return"><dt>Returns</dt><dd>On success, returns 0. If the DataRecord failed to decode, return -1. </dd></dl>

</div>
</div>
<a id="a6a6631604b6190a2203bf37db8b141f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a6631604b6190a2203bf37db8b141f5">&#9670;&nbsp;</a></span>decodeOneCompressed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int facebook::logdevice::BufferedWriteDecoder::decodeOneCompressed </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; DataRecord &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CompressedPayloadGroups &amp;&#160;</td>
          <td class="paramname"><em>compressed_payload_groups_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decodes record without uncompressing any of the payloads. Batch must be written using PayloadGroups API in <a class="el" href="classfacebook_1_1logdevice_1_1_buffered_writer.html">BufferedWriter</a>, otherwise decoding will fail. Claims ownership of DataRecord on success.</p>
<dl class="section return"><dt>Returns</dt><dd>On success, returns 0. If the DataRecord failed to decode, returns -1. </dd></dl>

</div>
</div>
<a id="a56317ec50f7c9deaf4a27bca50615be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56317ec50f7c9deaf4a27bca50615be1">&#9670;&nbsp;</a></span>getBatchSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int facebook::logdevice::BufferedWriteDecoder::getBatchSize </td>
          <td>(</td>
          <td class="paramtype">const DataRecord &amp;&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>size_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the number of individual records stored in a single DataRecord. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>logdevice/include/<a class="el" href="_buffered_write_decoder_8h_source.html">BufferedWriteDecoder.h</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer">
<small>
LogDevice API
</small>
</address>
</body>
</html>
